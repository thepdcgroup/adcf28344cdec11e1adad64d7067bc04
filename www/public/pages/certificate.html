<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="http://localhost/assets/global.css">
<link rel="stylesheet" href="http://localhost/assets/certificate.css">
<title>Self-Hosted - Course Material</title>
<style>
</style>
</head>
<body>
<div class='section_outter no_print' id='section_outter_header0'>
	<div class='section_inner' id='section_inner_header0'>
	<div id='parent_button_outter'>
		<a id='parent_button' href="http://localhost/index.html">Go to Parent Site</a>
	</div>
	</div>
</div>
<div class='section_outter no_print' id='section_outter_header1'>
	<div class='section_inner' id='section_inner_header1'>
	<nav id='navigation'>
		<a id='navigation_button' href="http://localhost/navigation.html">&#x2630;</a>
	</nav>
	</div>
</div>
<div class='section_outter no_print' id='content_section_outter'>
	<div class='section_inner' id='content_section_inner'>
		<div class="outter_h2"><div class="inner_h2">Verify</div></div>
<div>
You are currently verifying <label for="id_input">Certificate ID:</label>
    <input type="text" id="id_input">
If it is valid, a certificate will be displayed below.
</div>

<script>
// Get URL parameter by name
function get_url_parameter_value_v1(param_var) {
    var parameters_var = new URLSearchParams(window.location.search);
    var value_var = parameters_var.get(param_var);
    if (value_var === null || value_var === "" || value_var === undefined) {
        return false;
    }
    return value_var;
}

// Decode Certificate ID, and apply information
function decode_id_v1(id_value) {
	var switch_var = false;
	if (id_value !== null && id_value !== undefined && id_value !== '' && id_value !== false && id_value !== 'false') {
		var switch_var = true;
		console.log(id_value);
		// Decode ID to get Date Issued, and student's name. If fails, change switch_var to false.
		id_arr = id_value.split('');
		var reverse_map = {
			'0': '~',
			'1': '0',
			'2': '1',
			'3': '2',
			'4': '3',
			'5': '4',
			'6': '5',
			'7': '6',
			'8': '7',
			'9': '8',
			'a': '9',
			'b': 'a',
			'c': 'b',
			'd': 'c',
			'e': 'd',
			'f': 'e',
			'g': 'f',
			'h': 'g',
			'i': 'h',
			'j': 'i',
			'k': 'j',
			'l': 'k',
			'm': 'l',
			'n': 'm',
			'o': 'n',
			'p': 'o',
			'q': 'p',
			'r': 'q',
			's': 'r',
			't': 's',
			'u': 't',
			'v': 'u',
			'w': 'v',
			'x': 'w',
			'y': 'x',
			'z': 'y',
			'A': 'z',
			'B': 'A',
			'C': 'B',
			'D': 'C',
			'E': 'D',
			'F': 'E',
			'G': 'F',
			'H': 'G',
			'I': 'H',
			'J': 'I',
			'K': 'J',
			'L': 'K',
			'M': 'L',
			'N': 'M',
			'O': 'N',
			'P': 'O',
			'Q': 'P',
			'R': 'Q',
			'S': 'R',
			'T': 'S',
			'U': 'T',
			'V': 'U',
			'W': 'V',
			'X': 'W',
			'Y': 'X',
			'Z': 'Y',
			'~': 'Z'
		};
		for (var i = 0; i < id_arr.length; i++) {
  			if (reverse_map.hasOwnProperty(id_arr[i])) {
    			id_arr[i] = reverse_map[id_arr[i]];
 			 }
		}
		id_arr = id_arr.join('');
		id_arr = id_arr.replace(/~2/g, ",");
		id_arr = id_arr.replace(/~1/g, " ");
		id_arr = id_arr.replace(/~0/g, " | ");
		id_arr = id_arr.split(' | ');
		if (id_arr[0] !== null && id_value !== undefined && id_value !== '') {
			// Do nothing
		} else {
			var switch_var = false;
		}
		if (id_arr[1] !== null && id_value !== undefined && id_value !== '') {
			// Do nothing
		} else {
			var switch_var = false;
		}
	}
	if (switch_var === true){
		var ele = document.getElementById("certificate_verification_result");
		ele.innerHTML = 'Certificate is valid. To save a copy of the certificate, either screenshot it, or print it.';
		// Set Certificate ID in Certificate
		var ele = document.getElementById("certificate_id");
		ele.innerHTML = id_value;
		// Set Certificate Verification URL
		var ele = document.getElementById("certificate_link_a");
		ele.href = ele.innerHTML + id_value;
		ele.innerHTML = ele.innerHTML + id_value
		// Set Student Name
		var ele = document.getElementById("student");
		ele.innerHTML = id_arr[0];
		// Set Date Issued
		var ele = document.getElementById("date_issued");
		ele.innerHTML = id_arr[1];
	} else {
		var ele = document.getElementById("certificate_verification_result");
		ele.innerHTML = 'Certificate is invalid.';
		ele = document.getElementById("certificate_section_outter");
		ele.innerHTML = '';
	}
}

// Initialize input value from URL parameter (if present)
window.onload = function() {
    var id_var = get_url_parameter_value_v1("id");
    id_var = decodeURIComponent(id_var);
    var input_ele = document.getElementById("id_input");

    if (id_var !== null && id_var !== undefined) { // Check if id_var has a value
        input_ele.value = id_var;
        decode_id_v1(id_var);
    }

    // Attach event listener for input changes
    input_ele.addEventListener("input", function() {
        decode_id_v1(this.value);
    });
};
</script>
<div class="outter_h2"><div class="inner_h2">Result</div></div><div id="certificate_verification_result"></div>
	</div>
</div>
<div class='section_outter' id='certificate_section_outter'>
	<div class='section_inner' id='certificate_section_inner'>
		<div id='certificate_outter'>
		<div id='certificate_extra'>
		<div id='certificate_inner'>
		<div class="outter_h2" id="certificate_h2_outter"><div class="inner_h2" id="certificate_h2_inner">Academic Credential</div></div>
<div class="item"><div class="item_label">Course Name:</div><div class="item_value">Introduction to GitHub</div></div>
<div class="item"><div class="item_label">Course ID:</div><div class="item_value">adcf28344cdec11e1adad64d7067bc04</div></div>
<div class="item"><div class="item_label">Credential Issuer:</div><div class="item_value">Self-Hosted</div></div>
<div class="item"><div class="item_label">Credential Level:</div><div class="item_value">1</div></div>
<div class="item"><div class="item_label">Credential Type:</div><div class="item_value">NFE Certificate</div></div>
<div class="item"><div class="item_label">Credential Value:</div><div class="item_value">25 NFECs (Non-Formal Education Credits)</div></div>
<div class="item"><div class="item_label">Date Issued:</div><div class="item_value" id="date_issued"></div></div>
<div class="item"><div class="item_label">Student:</div><div class="item_value" id="student"></div></div>
<div class="item"><div class="item_label">Certificate ID:</div><div class="item_value" id="certificate_id"></div></div>
		</div>
		</div>
		</div>
		<div id='certificate_link'>Verification Link: <a id='certificate_link_a' href="http://localhost/pages/certificate.html?id=">http://localhost/pages/certificate.html?id=</a></div>
	</div>
</div>
<div class='section_outter no_print' id='section_outter_footer1'>
	<div class='section_inner' id='section_inner_footer1'>
		<div id='scroll_to_top'>
			<button onclick="scrollToTop()" id="topButton">&uArr;</button>
			<script>
				function scrollToTop() {
					document.body.scrollTop = 0;
					document.documentElement.scrollTop = 0;
				}
			</script>
		</div>
	</div>
</div>
<div class='section_outter no_print' id='section_outter_footer2'>
	<div class='section_inner' id='section_inner_footer2'>
		<div id='copyright_notice'>
			<p><a href="https://laws-lois.justice.gc.ca/eng/acts/C-42/Index.html">Copyright &#169</a> Self-Hosted, and others; <a href="https://en.wikipedia.org/wiki/All_rights_reserved">all rights reserved</a>, except where explicitly stated.
			</p>
		</div>
	</div>
</div>
</body>
</html>